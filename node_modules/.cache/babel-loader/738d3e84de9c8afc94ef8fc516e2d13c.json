{"ast":null,"code":"import _toConsumableArray from\"/home/cracked/Desktop/Ascension XX/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/home/cracked/Desktop/Ascension XX/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/cracked/Desktop/Ascension XX/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/cracked/Desktop/Ascension XX/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/cracked/Desktop/Ascension XX/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/cracked/Desktop/Ascension XX/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import firebase from'firebase';import EventCard from'./EventCard';import GoDown from'./GoDown';import Swal from'sweetalert2';import'./assets/css/EventCards.css';var EventCards=/*#__PURE__*/function(_Component){_inherits(EventCards,_Component);function EventCards(props){var _this;_classCallCheck(this,EventCards);_this=_possibleConstructorReturn(this,_getPrototypeOf(EventCards).call(this,props));_this.componentDidMount=function(){firebase.database().ref('/events').once('value').then(function(snapshot){_this.setState({events:snapshot.val()});}).catch(function(e){return console.log(e.code);});};_this.componentDidUpdate=function(){if(_this.props.show&&_this.state.events===null){window.location.reload();}};_this.eventAddedListener=function(eid){var event_regs=_this.state.cart;event_regs.push(eid);var totPay=0;var comboPrice=0;event_regs.forEach(function(evid){if(_this.state.events[evid].fee===\"100\"||_this.state.events[evid].fee===\"150\"){if(comboPrice<400){comboPrice+=Number(_this.state.events[evid].fee);}else{if(!_this.state.comboAvailed){_this.setState({comboAvailed:true});Swal.fire({icon:'success',title:'Combo Activated',text:'You\\'ve got a combo by selecting events of ₹150 and ₹100 worth ₹400+ you won\\'t be charged further for these categories during this purchase',confirmButtonColor:'#A90C35'});}}}else{totPay+=Number(_this.state.events[evid].fee);}});if(comboPrice>400){comboPrice=400;if(!_this.state.comboAvailed){_this.setState({comboAvailed:true});Swal.fire({icon:'success',title:'Combo Activated',text:'You\\'ve got a combo by selecting events of ₹150 and ₹100 worth ₹400+ you won\\'t be charged further for these categories during this purchase',confirmButtonColor:'#A90C35'});}}totPay+=comboPrice;_this.setState({cart:event_regs,totalPayable:totPay});};_this.eventRemovedListener=function(eid){var event_regs=_this.state.cart;var index=event_regs.indexOf(eid);if(index>-1){event_regs.splice(index,1);}var totPay=0;var comboPrice=0;event_regs.forEach(function(evid){if(_this.state.events[evid].fee===\"100\"||_this.state.events[evid].fee===\"150\"){if(comboPrice<400){comboPrice+=Number(_this.state.events[evid].fee);}}else{totPay+=Number(_this.state.events[evid].fee);}});if(comboPrice>400){comboPrice=400;}totPay+=comboPrice;_this.setState({cart:event_regs,totalPayable:totPay});};_this.togglePaymentHandler=function(){if(_this.state.payMethod==='Online'){_this.setState({payMethod:'At Desk'});}else{_this.setState({payMethod:'Online'});}};_this.checkoutHandler=function(){if(_this.state.cart.length!==0){firebase.database().ref('/participants/'+_this.props.user.uid).once('value').then(function(snapshot){var evs;if(snapshot.val().events===undefined){evs=_this.state.cart;}else{evs=[].concat(_toConsumableArray(snapshot.val().events),_toConsumableArray(_this.state.cart));}firebase.database().ref('/participants/'+_this.props.user.uid).update({events:evs}).then(function(){var count=0;_this.state.cart.forEach(function(eid){count++;firebase.database().ref('/event_participation/'+eid).push({uid:_this.props.user.uid,eventname:_this.state.events[eid].eventname,timestamp:Date.now(),username:_this.props.user.name});if(count===_this.state.cart.length){window.location.reload();}});}).catch(function(e){return console.log(e.message);});}).catch(function(em){return console.log(em.message);});}else{Swal.fire({icon:'warning',title:'Oops...',text:'Select an event First',confirmButtonColor:'#A90C35'});}};_this.state={events:null,cart:[],totalPayable:0,payMethod:'Online',comboAvailed:false,alertPopup:false};return _this;}_createClass(EventCards,[{key:\"render\",value:function render(){var _this2=this;var dat=this.props.user!==null?this.props.user.events:null;var nonRegisteredEvents=null;var registeredEvents=null;if(this.state.events!==null){nonRegisteredEvents=Object.keys(this.state.events).map(function(evKey){if(dat!==null&&dat!==undefined){if(!dat.includes(evKey)){return React.createElement(EventCard,{registered:false,data:_this2.state.events[evKey],key:evKey,eventAddedListener:_this2.eventAddedListener,eventRemovedListener:_this2.eventRemovedListener});}else{return null;}}else{return React.createElement(EventCard,{registered:false,data:_this2.state.events[evKey],key:evKey,eventAddedListener:_this2.eventAddedListener,eventRemovedListener:_this2.eventRemovedListener});}});if(dat!==null&&dat!==undefined){registeredEvents=dat.map(function(evKey){return React.createElement(EventCard,{registered:true,data:_this2.state.events[evKey],key:evKey,eventAddedListener:_this2.eventAddedListener,eventRemovedListener:_this2.eventRemovedListener});});}}return this.props.show?React.createElement(\"div\",{className:\"EventCards\"},React.createElement(\"div\",{className:\"participant-data\"},React.createElement(\"h4\",null,this.props.user!==null?'Hello '+this.props.user.name:''),this.props.user!==null?React.createElement(\"h6\",null,\"Your Dyuthi Id : \",React.createElement(\"span\",{className:\"non-dyuthi\"},React.createElement(\"b\",null,this.props.user.dyuthi_id))):React.createElement(React.Fragment,null)),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"div\",{class:\"container\"},React.createElement(\"h4\",null,\"Registered Events\"),React.createElement(\"div\",{class:\"row\"},registeredEvents),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"h4\",null,\"Other Events\"),React.createElement(\"div\",{className:\"row\"},nonRegisteredEvents)),React.createElement(GoDown,null),React.createElement(\"div\",{className:\"checkout-form\",id:\"bottom\"},React.createElement(\"h3\",null,\"Checkout\"),React.createElement(\"p\",null,\"Total Amount : \",this.state.totalPayable),React.createElement(\"p\",null,\"Payment Method : At Desk\"),React.createElement(\"p\",{className:\"disclaimer\"}),React.createElement(\"button\",{class:\"proceed-button\",onClick:this.checkoutHandler},\"Confirm Checkout\"))):null;}}]);return EventCards;}(Component);export default EventCards;","map":{"version":3,"sources":["/home/cracked/Desktop/Ascension XX/src/Components/EventCards.js"],"names":["React","Component","firebase","EventCard","GoDown","Swal","EventCards","props","componentDidMount","database","ref","once","then","snapshot","setState","events","val","catch","e","console","log","code","componentDidUpdate","show","state","window","location","reload","eventAddedListener","eid","event_regs","cart","push","totPay","comboPrice","forEach","evid","fee","Number","comboAvailed","fire","icon","title","text","confirmButtonColor","totalPayable","eventRemovedListener","index","indexOf","splice","togglePaymentHandler","payMethod","checkoutHandler","length","user","uid","evs","undefined","update","count","eventname","timestamp","Date","now","username","name","message","em","alertPopup","dat","nonRegisteredEvents","registeredEvents","Object","keys","map","evKey","includes","dyuthi_id"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n\nimport firebase from 'firebase';\n\nimport EventCard from './EventCard';\nimport GoDown from './GoDown';\nimport Swal from 'sweetalert2';\nimport './assets/css/EventCards.css';\n\nclass EventCards extends Component {\n    constructor(props) {\n        super(props);\n        this.state = { \n            events: null,\n            cart: [],\n            totalPayable: 0,\n            payMethod: 'Online',\n            comboAvailed: false,\n            alertPopup: false\n        }\n    }\n\n    componentDidMount = () => {\n        firebase.database().ref('/events')\n            .once('value').then((snapshot) => {\n                this.setState({events: snapshot.val()});                \n            }).catch(e => console.log(e.code));\n    }\n\n    componentDidUpdate = () => {\n        if (this.props.show && this.state.events === null) {\n            window.location.reload();\n        }\n    }\n\n    eventAddedListener = (eid) => {\n        let event_regs = this.state.cart;\n        event_regs.push(eid);\n        let totPay = 0;\n        let comboPrice = 0;\n        event_regs.forEach(evid => {\n            if(this.state.events[evid].fee === \"100\" || this.state.events[evid].fee === \"150\"){\n                if (comboPrice < 400){\n                    comboPrice += Number(this.state.events[evid].fee);\n                }\n                else{\n                    if(!this.state.comboAvailed){\n                        this.setState({comboAvailed: true});\n                        Swal.fire({\n                            icon: 'success',\n                            title: 'Combo Activated',\n                            text: 'You\\'ve got a combo by selecting events of ₹150 and ₹100 worth ₹400+ you won\\'t be charged further for these categories during this purchase',\n                            confirmButtonColor: '#A90C35'\n                        })                         \n                    }  \n                }\n            }else {\n                totPay += Number(this.state.events[evid].fee);\n            }\n        })\n        if (comboPrice > 400){\n            comboPrice = 400;\n            if(!this.state.comboAvailed){\n                this.setState({comboAvailed: true});\n                Swal.fire({\n                    icon: 'success',\n                    title: 'Combo Activated',\n                    text: 'You\\'ve got a combo by selecting events of ₹150 and ₹100 worth ₹400+ you won\\'t be charged further for these categories during this purchase',\n                    confirmButtonColor: '#A90C35'\n                })                         \n            }\n        }\n        totPay += comboPrice;\n        this.setState({cart: event_regs, totalPayable: totPay});\n    }\n\n    eventRemovedListener = (eid) => {\n        let event_regs = this.state.cart;\n        const index = event_regs.indexOf(eid);\n        if (index > -1) {\n            event_regs.splice(index, 1);\n        }\n        let totPay = 0;\n        let comboPrice = 0;\n        event_regs.forEach(evid => {\n            if(this.state.events[evid].fee === \"100\" || this.state.events[evid].fee === \"150\"){\n                if (comboPrice < 400){\n                    comboPrice += Number(this.state.events[evid].fee);\n                }\n            }else {\n                totPay += Number(this.state.events[evid].fee);\n            }\n        })\n        if (comboPrice > 400){\n            comboPrice = 400;\n        }\n        totPay += comboPrice;\n        this.setState({cart: event_regs, totalPayable: totPay});\n    }\n\n    togglePaymentHandler = () => {\n        if (this.state.payMethod === 'Online') {\n            this.setState({payMethod: 'At Desk'});\n        }else {\n            this.setState({payMethod: 'Online'});\n        }\n    }\n\n    checkoutHandler = () => {\n        if (this.state.cart.length !== 0) {\n            firebase.database().ref('/participants/'+this.props.user.uid).once('value')\n                .then((snapshot) => {\n                    let evs;\n                    if (snapshot.val().events === undefined){\n                        evs = this.state.cart;\n                    }else{\n                        evs = [...snapshot.val().events, ...this.state.cart];\n                    }\n                    firebase.database().ref('/participants/'+this.props.user.uid).update({\n                        events: evs\n                    }).then(() => {\n                        let count = 0;\n                        this.state.cart.forEach(eid => {\n                            count++;\n                            firebase.database().ref('/event_participation/'+eid).push({\n                                uid : this.props.user.uid,\n                                eventname: this.state.events[eid].eventname,\n                                timestamp: Date.now(),\n                                username: this.props.user.name\n                            });\n                            if (count === this.state.cart.length) {\n                                window.location.reload();\n                            }\n                        })\n                    }).catch(e => console.log(e.message));\n                }).catch(em => console.log(em.message));     \n        }else {\n            Swal.fire({\n                icon: 'warning',\n                title: 'Oops...',\n                text: 'Select an event First',\n                confirmButtonColor: '#A90C35'\n            })              \n        }\n    }\n\n    render() { \n        let dat = this.props.user !== null ? this.props.user.events : null;\n        let nonRegisteredEvents = null;\n        let registeredEvents = null;\n        if (this.state.events !== null){\n            nonRegisteredEvents = Object.keys(this.state.events)\n                            .map(evKey => {\n                                if (dat !== null && dat !== undefined) {\n                                    if (!dat.includes(evKey)) {\n                                        return <EventCard\n                                            registered={false} \n                                            data={this.state.events[evKey]} \n                                            key={evKey}\n                                            eventAddedListener={this.eventAddedListener}\n                                            eventRemovedListener={this.eventRemovedListener}/>\n                                    }else {\n                                        return null\n                                    }\n                                }else {\n                                    return <EventCard\n                                            registered={false} \n                                            data={this.state.events[evKey]} \n                                            key={evKey}\n                                            eventAddedListener={this.eventAddedListener}\n                                            eventRemovedListener={this.eventRemovedListener}/>\n                                }   \n                            });\n            if (dat !== null && dat !== undefined) {\n                registeredEvents = dat.map(evKey => {\n                    return <EventCard\n                            registered={true} \n                            data={this.state.events[evKey]} \n                            key={evKey}\n                            eventAddedListener={this.eventAddedListener}\n                            eventRemovedListener={this.eventRemovedListener}/>\n                });\n            }\n        }\n        \n        return ( \n            this.props.show ?\n            <div className=\"EventCards\">\n                <div className=\"participant-data\">\n                    <h4>{this.props.user !== null ? 'Hello '+this.props.user.name : ''}</h4>\n                    {this.props.user !== null?\n                    <h6>Your Dyuthi Id : <span className=\"non-dyuthi\"><b>{this.props.user.dyuthi_id}</b></span></h6>:\n                    <></>}\n                </div>\n                <br/>\n                <br/>\n\n                \n                <div class=\"container\">\n                    <h4>Registered Events</h4>\n                    <div class=\"row\">\n                        {registeredEvents}\n                    </div>\n                    <br/><br/><br/>\n                    <h4>Other Events</h4>\n                    <div className=\"row\">\n                        {nonRegisteredEvents}\n                    </div>\n                </div>\n                <GoDown />\n                <div className=\"checkout-form\" id=\"bottom\">\n                    <h3>Checkout</h3>\n                    <p>Total Amount : {this.state.totalPayable}</p>\n                    {/* <p>Payment Method : {this.state.payMethod}</p> */}\n                    <p>Payment Method : At Desk</p>\n                    {/* <div class=\"outer\">\n                        <span class=\"switcher switcher-2\">\n                            <input \n                                type=\"checkbox\" \n                                id=\"switcher-2\" \n                                onClick={this.togglePaymentHandler}/>\n                            <label for=\"switcher-2\"></label>\n                        </span>\n                    </div>   */}\n                    <p className=\"disclaimer\"></p>\n                    <button class=\"proceed-button\" onClick={this.checkoutHandler}>Confirm Checkout</button>\n                </div>\n            </div>\n            : null\n        );\n    }\n}\n \nexport default EventCards;"]},"metadata":{},"sourceType":"module"}