{"ast":null,"code":"var _jsxFileName = \"/home/cracked/Desktop/Ascension XX/src/Components/EventCards.js\";\nimport React, { Component } from 'react';\nimport firebase from 'firebase';\nimport EventCard from './EventCard';\nimport GoDown from './GoDown';\nimport Swal from 'sweetalert2';\nimport './assets/css/EventCards.css';\n\nclass EventCards extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = () => {\n      firebase.database().ref('/events').once('value').then(snapshot => {\n        this.setState({\n          events: snapshot.val()\n        });\n      }).catch(e => console.log(e.code));\n    };\n\n    this.componentDidUpdate = () => {\n      if (this.props.show && this.state.events === null) {\n        window.location.reload();\n      }\n    };\n\n    this.eventAddedListener = eid => {\n      let event_regs = this.state.cart;\n      event_regs.push(eid);\n      let totPay = 0;\n      let comboPrice = 0;\n      event_regs.forEach(evid => {\n        if (this.state.events[evid].fee === \"100\" || this.state.events[evid].fee === \"150\") {\n          if (comboPrice < 400) {\n            comboPrice += Number(this.state.events[evid].fee);\n          } else {\n            if (!this.state.comboAvailed) {\n              this.setState({\n                comboAvailed: true\n              });\n              Swal.fire({\n                icon: 'success',\n                title: 'Combo Activated',\n                text: 'You\\'ve got a combo by selecting events of ₹150 and ₹100 worth ₹400+ you won\\'t be charged further for these categories during this purchase',\n                confirmButtonColor: '#A90C35'\n              });\n            }\n          }\n        } else {\n          totPay += Number(this.state.events[evid].fee);\n        }\n      });\n\n      if (comboPrice > 400) {\n        comboPrice = 400;\n\n        if (!this.state.comboAvailed) {\n          this.setState({\n            comboAvailed: true\n          });\n          Swal.fire({\n            icon: 'success',\n            title: 'Combo Activated',\n            text: 'You\\'ve got a combo by selecting events of ₹150 and ₹100 worth ₹400+ you won\\'t be charged further for these categories during this purchase',\n            confirmButtonColor: '#A90C35'\n          });\n        }\n      }\n\n      totPay += comboPrice;\n      this.setState({\n        cart: event_regs,\n        totalPayable: totPay\n      });\n    };\n\n    this.eventRemovedListener = eid => {\n      let event_regs = this.state.cart;\n      const index = event_regs.indexOf(eid);\n\n      if (index > -1) {\n        event_regs.splice(index, 1);\n      }\n\n      let totPay = 0;\n      let comboPrice = 0;\n      event_regs.forEach(evid => {\n        if (this.state.events[evid].fee === \"100\" || this.state.events[evid].fee === \"150\") {\n          if (comboPrice < 400) {\n            comboPrice += Number(this.state.events[evid].fee);\n          }\n        } else {\n          totPay += Number(this.state.events[evid].fee);\n        }\n      });\n\n      if (comboPrice > 400) {\n        comboPrice = 400;\n      }\n\n      totPay += comboPrice;\n      this.setState({\n        cart: event_regs,\n        totalPayable: totPay\n      });\n    };\n\n    this.togglePaymentHandler = () => {\n      if (this.state.payMethod === 'Online') {\n        this.setState({\n          payMethod: 'At Desk'\n        });\n      } else {\n        this.setState({\n          payMethod: 'Online'\n        });\n      }\n    };\n\n    this.checkoutHandler = () => {\n      if (this.state.cart.length !== 0) {\n        firebase.database().ref('/participants/' + this.props.user.uid).once('value').then(snapshot => {\n          let evs;\n\n          if (snapshot.val().events === undefined) {\n            evs = this.state.cart;\n          } else {\n            evs = [...snapshot.val().events, ...this.state.cart];\n          }\n\n          firebase.database().ref('/participants/' + this.props.user.uid).update({\n            events: evs\n          }).then(() => {\n            let count = 0;\n            this.state.cart.forEach(eid => {\n              count++;\n              firebase.database().ref('/event_participation/' + eid).push({\n                uid: this.props.user.uid,\n                eventname: this.state.events[eid].eventname,\n                timestamp: Date.now(),\n                username: this.props.user.name\n              });\n\n              if (count === this.state.cart.length) {\n                window.location.reload();\n              }\n            });\n          }).catch(e => console.log(e.message));\n        }).catch(em => console.log(em.message));\n      } else {\n        Swal.fire({\n          icon: 'warning',\n          title: 'Oops...',\n          text: 'Select an event First',\n          confirmButtonColor: '#A90C35'\n        });\n      }\n    };\n\n    this.state = {\n      events: null,\n      cart: [],\n      totalPayable: 0,\n      payMethod: 'Online',\n      comboAvailed: false,\n      alertPopup: false\n    };\n  }\n\n  render() {\n    let dat = this.props.user !== null ? this.props.user.events : null;\n    let nonRegisteredEvents = null;\n    let registeredEvents = null;\n\n    if (this.state.events !== null) {\n      nonRegisteredEvents = Object.keys(this.state.events).map(evKey => {\n        if (dat !== null && dat !== undefined) {\n          if (!dat.includes(evKey)) {\n            return React.createElement(EventCard, {\n              registered: false,\n              data: this.state.events[evKey],\n              key: evKey,\n              eventAddedListener: this.eventAddedListener,\n              eventRemovedListener: this.eventRemovedListener,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 156\n              },\n              __self: this\n            });\n          } else {\n            return null;\n          }\n        } else {\n          return React.createElement(EventCard, {\n            registered: false,\n            data: this.state.events[evKey],\n            key: evKey,\n            eventAddedListener: this.eventAddedListener,\n            eventRemovedListener: this.eventRemovedListener,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 166\n            },\n            __self: this\n          });\n        }\n      });\n\n      if (dat !== null && dat !== undefined) {\n        registeredEvents = dat.map(evKey => {\n          return React.createElement(EventCard, {\n            registered: true,\n            data: this.state.events[evKey],\n            key: evKey,\n            eventAddedListener: this.eventAddedListener,\n            eventRemovedListener: this.eventRemovedListener,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 176\n            },\n            __self: this\n          });\n        });\n      }\n    }\n\n    return this.props.show ? React.createElement(\"div\", {\n      className: \"EventCards\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"participant-data\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, this.props.user !== null ? 'Hello ' + this.props.user.name : ''), this.props.user !== null ? React.createElement(\"h6\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, \"Your Dyuthi Id : \", React.createElement(\"span\", {\n      className: \"non-dyuthi\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, this.props.user.dyuthi_id))) : React.createElement(React.Fragment, null)), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      class: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, \"Registered Events\"), React.createElement(\"div\", {\n      class: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, registeredEvents), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }), React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, \"Other Events\"), React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, nonRegisteredEvents)), React.createElement(GoDown, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"checkout-form\",\n      id: \"bottom\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, \"Checkout\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, \"Total Amount : \", this.state.totalPayable), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, \"Payment Method : At Desk\"), React.createElement(\"p\", {\n      className: \"disclaimer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      class: \"proceed-button\",\n      onClick: this.checkoutHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, \"Confirm Checkout\"))) : null;\n  }\n\n}\n\nexport default EventCards;","map":{"version":3,"sources":["/home/cracked/Desktop/Ascension XX/src/Components/EventCards.js"],"names":["React","Component","firebase","EventCard","GoDown","Swal","EventCards","constructor","props","componentDidMount","database","ref","once","then","snapshot","setState","events","val","catch","e","console","log","code","componentDidUpdate","show","state","window","location","reload","eventAddedListener","eid","event_regs","cart","push","totPay","comboPrice","forEach","evid","fee","Number","comboAvailed","fire","icon","title","text","confirmButtonColor","totalPayable","eventRemovedListener","index","indexOf","splice","togglePaymentHandler","payMethod","checkoutHandler","length","user","uid","evs","undefined","update","count","eventname","timestamp","Date","now","username","name","message","em","alertPopup","render","dat","nonRegisteredEvents","registeredEvents","Object","keys","map","evKey","includes","dyuthi_id"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n\nimport firebase from 'firebase';\n\nimport EventCard from './EventCard';\nimport GoDown from './GoDown';\nimport Swal from 'sweetalert2';\nimport './assets/css/EventCards.css';\n\nclass EventCards extends Component {\n    constructor(props) {\n        super(props);\n        this.state = { \n            events: null,\n            cart: [],\n            totalPayable: 0,\n            payMethod: 'Online',\n            comboAvailed: false,\n            alertPopup: false\n        }\n    }\n\n    componentDidMount = () => {\n        firebase.database().ref('/events')\n            .once('value').then((snapshot) => {\n                this.setState({events: snapshot.val()});                \n            }).catch(e => console.log(e.code));\n    }\n\n    componentDidUpdate = () => {\n        if (this.props.show && this.state.events === null) {\n            window.location.reload();\n        }\n    }\n\n    eventAddedListener = (eid) => {\n        let event_regs = this.state.cart;\n        event_regs.push(eid);\n        let totPay = 0;\n        let comboPrice = 0;\n        event_regs.forEach(evid => {\n            if(this.state.events[evid].fee === \"100\" || this.state.events[evid].fee === \"150\"){\n                if (comboPrice < 400){\n                    comboPrice += Number(this.state.events[evid].fee);\n                }\n                else{\n                    if(!this.state.comboAvailed){\n                        this.setState({comboAvailed: true});\n                        Swal.fire({\n                            icon: 'success',\n                            title: 'Combo Activated',\n                            text: 'You\\'ve got a combo by selecting events of ₹150 and ₹100 worth ₹400+ you won\\'t be charged further for these categories during this purchase',\n                            confirmButtonColor: '#A90C35'\n                        })                         \n                    }  \n                }\n            }else {\n                totPay += Number(this.state.events[evid].fee);\n            }\n        })\n        if (comboPrice > 400){\n            comboPrice = 400;\n            if(!this.state.comboAvailed){\n                this.setState({comboAvailed: true});\n                Swal.fire({\n                    icon: 'success',\n                    title: 'Combo Activated',\n                    text: 'You\\'ve got a combo by selecting events of ₹150 and ₹100 worth ₹400+ you won\\'t be charged further for these categories during this purchase',\n                    confirmButtonColor: '#A90C35'\n                })                         \n            }\n        }\n        totPay += comboPrice;\n        this.setState({cart: event_regs, totalPayable: totPay});\n    }\n\n    eventRemovedListener = (eid) => {\n        let event_regs = this.state.cart;\n        const index = event_regs.indexOf(eid);\n        if (index > -1) {\n            event_regs.splice(index, 1);\n        }\n        let totPay = 0;\n        let comboPrice = 0;\n        event_regs.forEach(evid => {\n            if(this.state.events[evid].fee === \"100\" || this.state.events[evid].fee === \"150\"){\n                if (comboPrice < 400){\n                    comboPrice += Number(this.state.events[evid].fee);\n                }\n            }else {\n                totPay += Number(this.state.events[evid].fee);\n            }\n        })\n        if (comboPrice > 400){\n            comboPrice = 400;\n        }\n        totPay += comboPrice;\n        this.setState({cart: event_regs, totalPayable: totPay});\n    }\n\n    togglePaymentHandler = () => {\n        if (this.state.payMethod === 'Online') {\n            this.setState({payMethod: 'At Desk'});\n        }else {\n            this.setState({payMethod: 'Online'});\n        }\n    }\n\n    checkoutHandler = () => {\n        if (this.state.cart.length !== 0) {\n            firebase.database().ref('/participants/'+this.props.user.uid).once('value')\n                .then((snapshot) => {\n                    let evs;\n                    if (snapshot.val().events === undefined){\n                        evs = this.state.cart;\n                    }else{\n                        evs = [...snapshot.val().events, ...this.state.cart];\n                    }\n                    firebase.database().ref('/participants/'+this.props.user.uid).update({\n                        events: evs\n                    }).then(() => {\n                        let count = 0;\n                        this.state.cart.forEach(eid => {\n                            count++;\n                            firebase.database().ref('/event_participation/'+eid).push({\n                                uid : this.props.user.uid,\n                                eventname: this.state.events[eid].eventname,\n                                timestamp: Date.now(),\n                                username: this.props.user.name\n                            });\n                            if (count === this.state.cart.length) {\n                                window.location.reload();\n                            }\n                        })\n                    }).catch(e => console.log(e.message));\n                }).catch(em => console.log(em.message));     \n        }else {\n            Swal.fire({\n                icon: 'warning',\n                title: 'Oops...',\n                text: 'Select an event First',\n                confirmButtonColor: '#A90C35'\n            })              \n        }\n    }\n\n    render() { \n        let dat = this.props.user !== null ? this.props.user.events : null;\n        let nonRegisteredEvents = null;\n        let registeredEvents = null;\n        if (this.state.events !== null){\n            nonRegisteredEvents = Object.keys(this.state.events)\n                            .map(evKey => {\n                                if (dat !== null && dat !== undefined) {\n                                    if (!dat.includes(evKey)) {\n                                        return <EventCard\n                                            registered={false} \n                                            data={this.state.events[evKey]} \n                                            key={evKey}\n                                            eventAddedListener={this.eventAddedListener}\n                                            eventRemovedListener={this.eventRemovedListener}/>\n                                    }else {\n                                        return null\n                                    }\n                                }else {\n                                    return <EventCard\n                                            registered={false} \n                                            data={this.state.events[evKey]} \n                                            key={evKey}\n                                            eventAddedListener={this.eventAddedListener}\n                                            eventRemovedListener={this.eventRemovedListener}/>\n                                }   \n                            });\n            if (dat !== null && dat !== undefined) {\n                registeredEvents = dat.map(evKey => {\n                    return <EventCard\n                            registered={true} \n                            data={this.state.events[evKey]} \n                            key={evKey}\n                            eventAddedListener={this.eventAddedListener}\n                            eventRemovedListener={this.eventRemovedListener}/>\n                });\n            }\n        }\n        \n        return ( \n            this.props.show ?\n            <div className=\"EventCards\">\n                <div className=\"participant-data\">\n                    <h4>{this.props.user !== null ? 'Hello '+this.props.user.name : ''}</h4>\n                    {this.props.user !== null?\n                    <h6>Your Dyuthi Id : <span className=\"non-dyuthi\"><b>{this.props.user.dyuthi_id}</b></span></h6>:\n                    <></>}\n                </div>\n                <br/>\n                <br/>\n\n                \n                <div class=\"container\">\n                    <h4>Registered Events</h4>\n                    <div class=\"row\">\n                        {registeredEvents}\n                    </div>\n                    <br/><br/><br/>\n                    <h4>Other Events</h4>\n                    <div className=\"row\">\n                        {nonRegisteredEvents}\n                    </div>\n                </div>\n                <GoDown />\n                <div className=\"checkout-form\" id=\"bottom\">\n                    <h3>Checkout</h3>\n                    <p>Total Amount : {this.state.totalPayable}</p>\n                    {/* <p>Payment Method : {this.state.payMethod}</p> */}\n                    <p>Payment Method : At Desk</p>\n                    {/* <div class=\"outer\">\n                        <span class=\"switcher switcher-2\">\n                            <input \n                                type=\"checkbox\" \n                                id=\"switcher-2\" \n                                onClick={this.togglePaymentHandler}/>\n                            <label for=\"switcher-2\"></label>\n                        </span>\n                    </div>   */}\n                    <p className=\"disclaimer\"></p>\n                    <button class=\"proceed-button\" onClick={this.checkoutHandler}>Confirm Checkout</button>\n                </div>\n            </div>\n            : null\n        );\n    }\n}\n \nexport default EventCards;"]},"metadata":{},"sourceType":"module"}